# git-workflow

## git

### 一种分布式的版本管理工具。

svn 也是版本管理工具，但是是集中式的。

> 分布式和集中式的区别：
>
> 集中式需要一个服务端，所有的文件都存储在该服务端，当其他成员需要进行修改时先从服务端拉取最新内容，然后在本地修改，修改完成后提交到这个服务端。提交时需要连网，本地的修改在提交前无法保存。提交时有先后顺序，如果别人提交前别人修改了就会产生冲突。
>
> 分布式则意味着每个人都存储了最新版本和版本历史，每个成员本地都有一个仓库，每次提交成员只需比较远程仓库和自己仓库的差异内容，并完成合并。在本地进行修改时可以随时存储到当前自己的本地仓库，不用连网。等需要同步时连网即可。而且 git 会比较和远程仓库的异同，只是去提交这些修改点，因此非常快速。

## 为什么要使用 git

1. 多人协作
2. 版本管理
3. 远程工作

## git workflow

在实际的工作情形中，使用 git 的每个成员分工合作，如何确保协作能够顺利，平稳，不混乱地进行下去，就要指定一些协作的规则， 这些规则或者策略就叫做 Git workflow.

### 分为三种：

1. git-flow
2. github-flow
3. gitlab-flow


### git-flow

git flow 是最早提出，并使用最为广泛的一种工作流方式。

git flow 中有两个长期分支：


> master - 可即时发布到线上的版本

> develop - 开发分支

三个临时分支：

> feature - 新功能分支

> hotfix - 热更新分支，用于修改已发版的内容的 bug

> release - 准备部署分支


两个长期分支在项目进程中一直存在，其他的临时分支都由develop 分支或 master 拉取，在进行一段时间的修改后合并入原分支。

其中 hosfix 分支由已上线的 master 分支拉取，用以修改上线版本的 bug，修改完成后合并入 master 分支和 develop 分支

release 分支是在开始上线前测试时从 develop 拉取，这样下一迭代内容和上线测试 bug 修改可以同步进行。在 bug 修改完成要上线时合并回 develop 分支，再推到 master 分支进行上线。

git-flow 的优缺点总结：

* 优点：按需求进行分支设定，完成后推入主线，流程清晰可控。
* 缺点：相对复杂， 而且要同时维护两个分支，有些 git 管理工具中默认是 master 为开发分支，需要切换到 develop 分支。对于有些需要持续发布的网站，每次提交就会进行一次部署，此时并不需要区分两个分支。

### github-flow

github-flow 是 git-flow 的简化版，它主要是用于 github 网站使用的工作流。

github flow 只有一个长期分支：

> master - 发布到线上的版本

根据需求可以从 master 拉取功能或补丁分支，在开发完成后向 master 分支提交 pull request, 该 pull request 可以开放评论功能，由其他人或审核者提交修改建议和评论，当 pull request 被通过后，代码被合并到 master 分支，可以删除原有分支。


github flow 的优缺点总结：

* 优点：简单，通过 pull request 可以进行评论功能极大提高了代码层面的交流。
* 缺点：虽然很适合即时发布型的项目，但是对于需要外部审核才能发布的项目不友好。

### gitlab-flow

gitlab flow 结合 github flow 和 git flow。

采用`上游优先`原则，例如，项目开发环境为 master，则再开启需要的其他分支，合并时采取只有上游采纳的代码才能被合并到其他分支。

所以开发或者修改顺序必须为  master => otherBranch => production

对于版本发布它的规定是在每次部署时相应地拉取对应分支，例如: 
`stable-1.0.0`， `stable-2.0.0` 后面如果对应的版本出现严重问题，则进行修改后合并到对应分支，并修改小版本号。



目前项目采取 git flow + gitlab flow

两个长期分支+三个临时分支。

版本发布时拉取对应版本的分支。


